<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIINKind - Donasi Pembangunan Jepara</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3B82F6;
            --secondary: #10B981;
            --accent: #F59E0B;
            --light: #F8FAFC;
            --dark: #1E293B;
            --text: #334155;
            --border: #E2E8F0;
            --highlight: #F1F5F9;
            --shadow: 4px 4px 0 var(--dark);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Space Grotesk', sans-serif;
        }

        body {
            background-color: var(--light);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: var(--text);
            position: relative;
        }

        .container {
            width: 100%;
            max-width: 520px;
            background: white;
            border-radius: 0;
            padding: 32px;
            position: relative;
            box-shadow: var(--shadow);
            border: 2px solid var(--dark);
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 32px;
            border-bottom: 2px solid var(--dark);
            padding-bottom: 16px;
        }

        .logo {
            font-size: 32px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .logo i {
            color: var(--primary);
        }

        .header h2 {
            font-size: 18px;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.8;
        }

        .campaign-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .campaign-tab {
            padding: 8px 16px;
            border: 2px solid var(--dark);
            background: white;
            border-radius: 0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .campaign-tab.active {
            background: var(--dark);
            color: white;
        }

        .campaign-tab:hover:not(.active) {
            background: var(--highlight);
        }

        .campaign-card {
            background: white;
            border-radius: 0;
            padding: 20px;
            margin-bottom: 24px;
            border: 2px solid var(--dark);
            position: relative;
        }

        .campaign-card::after {
            content: '';
            position: absolute;
            bottom: -8px;
            right: -8px;
            width: 100%;
            height: 100%;
            border: 2px solid var(--dark);
            z-index: -1;
        }

        .campaign-title {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
        }

        .campaign-desc {
            font-size: 15px;
            color: var(--text);
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .campaign-progress {
            margin-bottom: 16px;
        }

        .progress-bar {
            height: 12px;
            background: var(--border);
            border: 2px solid var(--dark);
            margin-bottom: 6px;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 65%;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 15px;
        }

        .input-wrapper {
            position: relative;
        }

        .input-wrapper i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark);
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 14px 14px 14px 48px;
            border: 2px solid var(--dark);
            border-radius: 0;
            font-size: 16px;
            transition: all 0.2s;
            background: white;
        }

        .form-group textarea {
            min-height: 100px;
            padding-left: 16px;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            box-shadow: 2px 2px 0 var(--dark);
        }

        .amount-options {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .amount-button {
            padding: 12px 20px;
            border: 2px solid var(--dark);
            background: white;
            border-radius: 0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 15px;
            flex-grow: 1;
            text-align: center;
        }

        .amount-button:hover {
            transform: translate(-2px, -2px);
            box-shadow: 2px 2px 0 var(--dark);
        }

        .amount-button.active {
            background: var(--dark);
            color: white;
            box-shadow: 2px 2px 0 var(--dark);
        }

        .custom-amount {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .currency {
            font-weight: 600;
            font-size: 18px;
        }

        .donate-button {
            width: 100%;
            padding: 16px;
            background: var(--dark);
            color: white;
            border: 2px solid var(--dark);
            border-radius: 0;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 16px;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .donate-button:hover {
            transform: translate(-4px, -4px);
            box-shadow: 4px 4px 0 var(--dark);
        }

        .donate-button:active {
            transform: translate(0, 0);
            box-shadow: none;
        }

        #qrcode {
            margin-top: 24px;
            padding: 24px;
            border: 2px solid var(--dark);
            border-radius: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 280px;
            background: white;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }

        #qrcode::after {
            content: '';
            position: absolute;
            bottom: -8px;
            right: -8px;
            width: 100%;
            height: 100%;
            border: 2px solid var(--dark);
            z-index: -1;
        }

        .qr-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            color: var(--text);
        }

        .qr-placeholder i {
            font-size: 48px;
            color: var(--border);
        }

        .qr-amount {
            margin-top: 16px;
            font-weight: 700;
            color: var(--dark);
            font-size: 22px;
        }

        .qr-meta {
            margin-top: 12px;
            font-size: 14px;
            color: var(--text);
            max-width: 80%;
            line-height: 1.5;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            width: 100%;
        }

        .action-button {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--dark);
            background: white;
            border-radius: 0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-button.print {
            background: var(--dark);
            color: white;
        }

        .action-button:hover {
            transform: translate(-2px, -2px);
            box-shadow: 2px 2px 0 var(--dark);
        }

        .disclaimer {
            margin-top: 32px;
            padding: 16px;
            border: 2px solid var(--dark);
            background: var(--highlight);
            font-size: 13px;
            line-height: 1.6;
        }

        .disclaimer strong {
            font-weight: 700;
        }

        .footer {
            margin-top: 32px;
            text-align: center;
            font-size: 13px;
            color: var(--text);
            opacity: 0.8;
            border-top: 2px solid var(--dark);
            padding-top: 16px;
        }

        .animate-pop {
            animation: pop 0.3s ease-out;
        }

        .confirm-section {
            margin-top: 24px;
            padding: 16px;
            border: 2px solid var(--dark);
            background: var(--highlight);
            display: none;
        }

        .confirm-title {
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .confirm-button {
            width: 100%;
            padding: 12px;
            background: var(--secondary);
            color: white;
            border: 2px solid var(--dark);
            border-radius: 0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 12px;
        }

        .confirm-button:hover {
            transform: translate(-2px, -2px);
            box-shadow: 2px 2px 0 var(--dark);
        }

        @keyframes pop {
            0% { transform: scale(0.95); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @media print {
            body * {
                visibility: hidden;
            }
            #qrcode, #qrcode * {
                visibility: visible;
            }
            #qrcode {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                border: none;
                box-shadow: none;
            }
            #qrcode::after {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 24px;
            }
            
            .amount-options {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <i class="fas fa-hands-helping"></i>
                <span>SIINKind</span>
            </div>
            <h2>DONASI UNTUK JEPARA</h2>
            <p>Bantu pembangunan infrastruktur & kesejahteraan masyarakat</p>
        </div>

        <div class="campaign-tabs">
            <div class="campaign-tab active" data-campaign="jalan" data-code="9">Perbaikan Jalan</div>
            <div class="campaign-tab" data-campaign="pendidikan" data-code="8">Beasiswa Pendidikan</div>
            <div class="campaign-tab" data-campaign="kesehatan" data-code="7">Fasilitas Kesehatan</div>
            <div class="campaign-tab" data-campaign="lainnya" data-code="6">Lainnya</div>
        </div>

        <div class="campaign-card" id="jalan-campaign">
            <div class="campaign-title">
                <i class="fas fa-road"></i>
                <span>Perbaikan Jalan Desa</span>
            </div>
            <div class="campaign-desc">
                Donasi Anda akan digunakan untuk perbaikan jalan di desa-desa terpencil Jepara. Membantu akses transportasi warga, memperlancar distribusi barang, dan meningkatkan perekonomian lokal.
            </div>
            <div class="campaign-progress">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span>Terkumpul: Rp 750.000</span>
                    <span>Target: Rp 65.000.000</span>
                </div>
            </div>
        </div>

        <div class="campaign-card" id="pendidikan-campaign" style="display: none;">
            <div class="campaign-title">
                <i class="fas fa-book-open"></i>
                <span>Beasiswa Pendidikan</span>
            </div>
            <div class="campaign-desc">
                Bantu anak-anak kurang mampu di Jepara untuk terus bersekolah. Donasi akan digunakan untuk biaya sekolah, seragam, buku, dan kebutuhan pendidikan lainnya.
            </div>
            <div class="campaign-progress">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 40%;"></div>
                </div>
                <div class="progress-text">
                    <span>Terkumpul: Rp 300.000</span>
                    <span>Target: Rp 30.000.000</span>
                </div>
            </div>
        </div>

        <div class="campaign-card" id="kesehatan-campaign" style="display: none;">
            <div class="campaign-title">
                <i class="fas fa-hospital"></i>
                <span>Fasilitas Kesehatan</span>
            </div>
            <div class="campaign-desc">
                Perbaikan dan pengadaan alat kesehatan untuk puskesmas dan posyandu di daerah terpencil Jepara. Donasi Anda akan menyelamatkan banyak nyawa.
            </div>
            <div class="campaign-progress">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 25%;"></div>
                </div>
                <div class="progress-text">
                    <span>Terkumpul: Rp 500.000</span>
                    <span>Target: Rp 30.000.000</span>
                </div>
            </div>
        </div>

        <div class="campaign-card" id="lainnya-campaign" style="display: none;">
            <div class="campaign-title">
                <i class="fas fa-heart"></i>
                <span>Bantuan Lainnya</span>
            </div>
            <div class="campaign-desc">
                Donasi untuk berbagai kebutuhan mendesak masyarakat Jepara, termasuk bantuan bencana, modal usaha kecil, dan program pemberdayaan masyarakat.
            </div>
            <div class="form-group">
                <label>Keterangan Donasi (Opsional)</label>
                <textarea id="donationNote" placeholder="Tulis tujuan spesifik donasi Anda (jika ada)"></textarea>
            </div>
        </div>

        <input type="hidden" id="qrisInput" value="00020101021126610014COM.GO-JEK.WWW01189360091432840999140210G2840999140303UMI51440014ID.CO.QRIS.WWW0215ID10253780771980303UMI5204549953033605802ID5916SIINMEDIA, PCNGN6006JEPARA61055946262070703A01630456FE">

        <div class="form-group">
            <label>Nama Donatur (Opsional)</label>
            <div class="input-wrapper">
                <i class="fas fa-user"></i>
                <input type="text" id="nameInput" placeholder="Nama Anda">
            </div>
        </div>

        <div class="form-group">
            <label>Nomor WhatsApp (Opsional)</label>
            <div class="input-wrapper">
                <i class="fas fa-phone"></i>
                <input type="tel" id="phoneInput" placeholder="08xxxxxxxxxx">
            </div>
        </div>

        <div class="form-group">
            <label>Jumlah Donasi</label>
            <div class="amount-options">
                <button class="amount-button" data-amount="10000">Rp 10K</button>
                <button class="amount-button" data-amount="50000">Rp 50K</button>
                <button class="amount-button" data-amount="100000">Rp 100K</button>
                <button class="amount-button" data-amount="200000">Rp 200K</button>
            </div>
            <div class="custom-amount">
                <span class="currency">Rp</span>
                <div class="input-wrapper" style="flex-grow: 1;">
                    <input type="number" 
                           id="nominalInput" 
                           placeholder="Masukkan jumlah donasi"
                           min="1"
                           step="1000"
                           style="padding-left: 16px;">
                </div>
            </div>
        </div>

        <button class="donate-button" onclick="generateQRIS()">
            <i class="fas fa-qrcode"></i> Generate QRIS Donasi
        </button>

        <div id="qrcode">
            <div class="qr-placeholder">
                <i class="fas fa-qrcode"></i>
                <p>QR Code donasi akan muncul di sini</p>
                <p class="qr-meta">Masukkan jumlah donasi dan klik tombol di atas</p>
            </div>
        </div>

        <div class="confirm-section" id="confirmSection">
            <div class="confirm-title">
                <i class="fas fa-check-circle"></i>
                <span>Konfirmasi Donasi</span>
            </div>
            <p>Setelah melakukan pembayaran, silakan konfirmasi dengan mengklik tombol di bawah ini. Kami akan memverifikasi donasi Anda segera.</p>
            <button class="confirm-button" onclick="sendConfirmation()">
                <i class="fab fa-whatsapp"></i> Konfirmasi via WhatsApp
            </button>
        </div>

        <div class="disclaimer">
            <strong>PERHATIAN:</strong> SIINKind adalah platform donasi independen yang tidak berafiliasi dengan pemerintah atau lembaga resmi apapun. Donasi bersifat sukarela tanpa batas minimum. Dana akan dikelola secara transparan oleh tim relawan SIINKind untuk kepentingan masyarakat Jepara.
        </div>

        <div class="footer">
            <p>© 2025 SIINKind - Semua donasi terekam secara transparan</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
    <script>
        // Campaign tabs functionality
        const tabs = document.querySelectorAll('.campaign-tab');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Hide all campaign cards
                document.querySelectorAll('.campaign-card').forEach(card => {
                    card.style.display = 'none';
                });
                
                // Show selected campaign card
                const campaignId = tab.dataset.campaign + '-campaign';
                document.getElementById(campaignId).style.display = 'block';
            });
        });

        // Format currency input
        const nominalInput = document.getElementById('nominalInput');
        const amountButtons = document.querySelectorAll('.amount-button');
        const qrcodeElement = document.getElementById('qrcode');
        const confirmSection = document.getElementById('confirmSection');

        // Set amount from buttons
        amountButtons.forEach(button => {
            button.addEventListener('click', () => {
                amountButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const amount = button.dataset.amount;
                nominalInput.value = amount;
            });
        });

        // Validate input is number
        nominalInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        // QRIS generation functions
        function pad(number) {
            return number < 10 ? '0' + number : number.toString();
        }

        function toCRC16(input) {
            let crc = 0xFFFF;
            for (let i = 0; i < input.length; i++) {
                crc ^= input.charCodeAt(i) << 8;
                for (let j = 0; j < 8; j++) {
                    crc = (crc & 0x8000) ? (crc << 1) ^ 0x1021 : crc << 1;
                }
            }
            let hex = (crc & 0xFFFF).toString(16).toUpperCase();
            return hex.length === 3 ? "0" + hex : hex;
        }

        function makeString(qris, { nominal, campaignCode } = {}) {
            // Add campaign code to the last digit of nominal
            let nominalWithCode = nominal.toString();
            if (!nominalWithCode.endsWith(campaignCode)) {
                nominalWithCode = nominalWithCode.replace(/\d$/, campaignCode);
            }
            
            let qrisModified = qris.slice(0, -4).replace("010211", "010212");
            let qrisParts = qrisModified.split("5802ID");

            let amount = "54" + pad(nominalWithCode.toString().length) + nominalWithCode;
            amount += "5802ID";

            let output = qrisParts[0].trim() + amount + qrisParts[1].trim();
            output += toCRC16(output);

            return output;
        }

        function generateQRIS() {
            const qrisInput = document.getElementById('qrisInput').value.trim();
            let nominalValue = nominalInput.value.trim();
            const nominal = parseInt(nominalValue || '0');
            
            if (!nominal || nominal <= 0) {
                alert('Silakan masukkan jumlah donasi yang valid');
                nominalInput.focus();
                return;
            }

            const name = document.getElementById('nameInput').value.trim();
            const phone = document.getElementById('phoneInput').value.trim();
            const activeTab = document.querySelector('.campaign-tab.active');
            const campaignCode = activeTab.dataset.code;
            const campaignName = activeTab.textContent.trim();
            const donationNote = document.getElementById('donationNote') ? document.getElementById('donationNote').value.trim() : '';
            
            // Generate nominal with campaign code
            const nominalWithCode = parseInt(nominal.toString().replace(/\d$/, campaignCode));
            
            const qrisDinamis = makeString(qrisInput, { 
                nominal: nominalWithCode,
                campaignCode: campaignCode
            });
            
            qrcodeElement.innerHTML = '';
            qrcodeElement.classList.add('animate-pop');
            
            QRCode.toCanvas(qrisDinamis, {
                margin: 2,
                width: 200,
                scale: 6,
                color: {
                    dark: '#1E293B',
                    light: '#ffffff'
                }
            }, function (err, canvas) {
                if (err) {
                    console.error(err);
                    qrcodeElement.innerHTML = `
                        <div class="qr-placeholder">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>Gagal membuat QR Code</p>
                        </div>
                    `;
                } else {
                    const amountDisplay = document.createElement('div');
                    amountDisplay.className = 'qr-amount';
                    amountDisplay.textContent = `Rp${nominal.toLocaleString('id-ID')}`;
                    
                    const metaInfo = document.createElement('div');
                    metaInfo.className = 'qr-meta';
                    
                    let infoText = 'Scan QR code ini untuk menyelesaikan donasi Anda';
                    
                    if (name) {
                        infoText += `<br>Donatur: ${name}`;
                    }
                    
                    infoText += `<br>Tujuan: ${campaignName}`;
                    
                    if (donationNote) {
                        infoText += `<br>Catatan: ${donationNote}`;
                    }
                    
                    metaInfo.innerHTML = infoText;
                    
                    const actionButtons = document.createElement('div');
                    actionButtons.className = 'action-buttons';
                    actionButtons.innerHTML = `
                        <button class="action-button" onclick="window.location.reload()">
                            <i class="fas fa-redo"></i> Buat Baru
                        </button>
                        <button class="action-button print" onclick="window.print()">
                            <i class="fas fa-print"></i> Cetak QR
                        </button>
                    `;
                    
                    qrcodeElement.appendChild(canvas);
                    qrcodeElement.appendChild(amountDisplay);
                    qrcodeElement.appendChild(metaInfo);
                    qrcodeElement.appendChild(actionButtons);
                    
                    // Show confirmation section
                    confirmSection.style.display = 'block';
                    
                    // Scroll to QR code
                    qrcodeElement.scrollIntoView({ behavior: 'smooth' });
                }
                qrcodeElement.classList.remove('animate-pop');
            });
        }

        function sendConfirmation() {
            const name = document.getElementById('nameInput').value.trim() || 'Anonim';
            const phone = document.getElementById('phoneInput').value.trim();
            const nominal = document.getElementById('nominalInput').value.trim();
            const activeTab = document.querySelector('.campaign-tab.active');
            const campaignName = activeTab.textContent.trim();
            const donationNote = document.getElementById('donationNote') ? document.getElementById('donationNote').value.trim() : '';
            
            if (!nominal || isNaN(nominal)) {
                alert('Silakan masukkan jumlah donasi yang valid terlebih dahulu');
                return;
            }
            
            const whatsappNumber = '6282324159922';
            let message = `Halo admin SIINKind, saya ingin mengkonfirmasi donasi dengan detail berikut:\n\n`;
            message += `Nama: ${name}\n`;
            message += `Nominal Donasi: Rp ${parseInt(nominal).toLocaleString('id-ID')}\n`;
            message += `Tujuan Donasi: ${campaignName}\n`;
            
            if (phone) {
                message += `Nomor WhatsApp: ${phone}\n`;
            }
            
            if (donationNote) {
                message += `Catatan: ${donationNote}\n`;
            }
            
            message += `\nSaya telah melakukan pembayaran sesuai QRIS yang diberikan. Mohon konfirmasi penerimaannya. Terima kasih.`;
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
        }
    </script>
</body>
</html>
